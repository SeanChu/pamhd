<!DOCTYPE html>
<html><head><meta charset="utf-8"></meta></head></html>
<!--
Interactive interface for creating configuration files for MHD test of PAMHD.

Copyright 2015 Ilja Honkonen
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice, this
  list of conditions and the following disclaimer in the documentation and/or
  other materials provided with the distribution.

* Neither the names of the copyright holders nor the names of their contributors
  may be used to endorse or promote products derived from this software
  without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html>
<head>
<title>Interactive configuration file creator for MHD test program of PAMHD</title>

<!-- javascript block start -->

<noscript>
	<p><h1>WARNING: This page does not work without javascript</h1></p>
</noscript>
<script src="http://cdnjs.cloudflare.com/ajax/libs/mathjs/2.4.1/math.min.js" type="text/javascript"></script>
<script>window.math || document.write('<script src="math.min.js">\x3C/script>')</script>
<script name="script" type="text/javascript">

<!-- javascript functions start -->

// variable sets available in math expressions
var
	empty_context = {},
	time_place_context = {
		t: 0,
		r: [0, 0, 0]
	},
	time_place_current_context = {
		t: 0,
		r: [0, 0, 0],
		J: 0
	};


//! returns true for number > 0, false otherwise
function gt_zero(number) {
	if (isFinite(number)) {
		if (number > 0) {
			return true;
		}
	}
	return false;
}


function validate_expression(element_id, validator, context) {
	expression = document.getElementById(element_id);
	result = document.getElementById(element_id + "_test");

	// mathjs starts indices from 1
	adjusted_expression = expression.value
		.split("[3]").join("[4]")
		.split("[2]").join("[3]")
		.split("[1]").join("[2]")
		.split("[0]").join("[1]");

	try {
		var evaluated = math.eval(adjusted_expression, context);
		if (validator(evaluated)) {
			result.innerHTML = "";
			result.style.color = "initial";
			return;
		} else {
			result.innerHTML = "Invalid value in expression";
			result.style.color = "red";
			return;
		}
	} catch(error) {
		result.innerHTML = "Error in expression";
		result.style.color = "red";
		return;
	}
}

//! Returns a text input element with given id and identical name.
//! Uses validator with given context/scope to validate expression typed into returned text element.
function make_boundary_variable(id_string, validator_str, context_str) {
//function make_boundary_variable(id_string, validator, context) {
	var input = document.createElement("input");
	input.setAttribute("type", "text");
	input.setAttribute("id", id_string);
	input.setAttribute("name", id_string);
	if (typeof validator_str == "string")
	if (validator_str != "")
	if (typeof context_str == "string")
	if (context_str != "") {
		input.setAttribute("onKeyUp", "validate_expression(this.id," + validator_str + ", " + context_str + ")");
	}
	return input;
}


window.onload = function() {

if (typeof math == "undefined") {
	document.body.innerHTML = "ERROR: Could not load math.js library!";
	return;
}

var
	init_boxes = 0,
	init_spheres = 0,
	value_boxes = 0,
	value_spheres = 0,
	copy_boxes = 0,
	copy_spheres = 0,
	// references to buttons for adding simulation features
	init_box_adder = document.getElementById("add_init_box"),
	init_box_remover = document.getElementById("remove_init_box"),
	init_sphere_adder = document.getElementById("add_init_sphere"),
	init_sphere_remover = document.getElementById("remove_init_sphere"),
	value_box_adder = document.getElementById("add_value_box"),
	value_box_remover = document.getElementById("remove_value_box"),
	value_sphere_adder = document.getElementById("add_value_sphere"),
	value_sphere_remover = document.getElementById("remove_value_sphere"),
	copy_box_adder = document.getElementById("add_copy_box"),
	copy_box_remover = document.getElementById("remove_copy_box"),
	copy_sphere_adder = document.getElementById("add_copy_sphere"),
	copy_sphere_remover = document.getElementById("remove_copy_sphere"),
	config_text_updater = document.getElementById("update_config_text"),
	// form that will be submitted
	form = document.getElementById("form"),
	clearer = document.getElementById("clear"),
	// references to buttons creating example simulations
	shock_tube_maker = document.getElementById("make_shock_tube"),
	kelvin_helmholtz_maker = document.getElementById("make_kelvin_helmholtz"),
	reconnection_maker = document.getElementById("make_reconnection"),
	orszag_tang_maker = document.getElementById("make_orszag_tang"),
	bow_shock_maker = document.getElementById("make_bow_shock"),
	blast_wave_maker = document.getElementById("make_blast_wave");


//! returns a set of input elements for given boundary
function make_boundary(shape, id_prefix, boundary_number) {
	id_string = id_prefix + boundary_number;

	var fieldset = document.createElement("fieldset");
	fieldset.setAttribute("id", id_string);

	var legend = document.createElement("legend");
	if (id_string.lastIndexOf("init") == 0) {
		legend.innerHTML
			= "Initial condition inside "
			+ shape + " "
			+ boundary_number;
	} else if (id_string.lastIndexOf("value") == 0) {
		legend.innerHTML
			= "State inside "
			+ shape + " "
			+ boundary_number
			+ " after given time";
	} else if (id_string.lastIndexOf("copy") == 0) {
		legend.innerHTML
			= "Region inside "
			+ shape
			+ boundary_number
			+ " where simulation state is copied to"
			+ " from nearest non-boundary cell";
	}
	fieldset.appendChild(legend);

	//! errors from expression validation are shown in these
	function make_span(id_string) {
		var span = document.createElement("span");
		span.setAttribute("id", id_string);
		return span;
	}

	if (shape == "box") {

		fieldset.appendChild(document.createTextNode("Start coordinate (x, y, z) "));
		fieldset.appendChild(make_boundary_variable(id_string + "_startx", "isFinite", "empty_context"));
		fieldset.appendChild(make_boundary_variable(id_string + "_starty", "isFinite", "empty_context"));
		fieldset.appendChild(make_boundary_variable(id_string + "_startz", "isFinite", "empty_context"));
		fieldset.appendChild(make_span(id_string + "_startx_test"));
		fieldset.appendChild(make_span(id_string + "_starty_test"));
		fieldset.appendChild(make_span(id_string + "_startz_test"));
		fieldset.appendChild(document.createElement("br"));

		fieldset.appendChild(document.createTextNode("End coordinate (x, y, z) "));
		fieldset.appendChild(make_boundary_variable(id_string + "_endx", "isFinite", "empty_context"));
		fieldset.appendChild(make_boundary_variable(id_string + "_endy", "isFinite", "empty_context"));
		fieldset.appendChild(make_boundary_variable(id_string + "_endz", "isFinite", "empty_context"));
		fieldset.appendChild(make_span(id_string + "_endx_test"));
		fieldset.appendChild(make_span(id_string + "_endy_test"));
		fieldset.appendChild(make_span(id_string + "_endz_test"));
		fieldset.appendChild(document.createElement("br"));

	} else if (shape == "sphere") {

		fieldset.appendChild(document.createTextNode("Center coordinate (x, y, z) "));
		fieldset.appendChild(make_boundary_variable(id_string + "_centerx", "isFinite", "empty_context"));
		fieldset.appendChild(make_boundary_variable(id_string + "_centery", "isFinite", "empty_context"));
		fieldset.appendChild(make_boundary_variable(id_string + "_centerz", "isFinite", "empty_context"));
		fieldset.appendChild(make_span(id_string + "_centerx_test"));
		fieldset.appendChild(make_span(id_string + "_centery_test"));
		fieldset.appendChild(make_span(id_string + "_centerz_test"));
		fieldset.appendChild(document.createElement("br"));

		fieldset.appendChild(document.createTextNode("Radius "));
		fieldset.appendChild(make_boundary_variable(id_string + "_radius", "gt_zero", "empty_context"));
		fieldset.appendChild(make_span(id_string + "_radius_test"));
		fieldset.appendChild(document.createElement("br"));
	}

	// value boundaries have a time item
	if (id_string.lastIndexOf("value") == 0) {
		fieldset.appendChild(document.createTextNode("Time "));
		fieldset.appendChild(make_boundary_variable(id_string + "_time", "isFinite", "empty_context"));
		fieldset.appendChild(make_span(id_string + "_time_test"));
		fieldset.appendChild(document.createElement("br"));
	}

	//! users cannot set MHD state of copy boundaries
	if (id_string.lastIndexOf("copy") == 0) {
	} else {
		fieldset.appendChild(document.createTextNode("Number density "));
		fieldset.appendChild(make_boundary_variable(id_string + "_mass", "gt_zero", "time_place_context"));
		fieldset.appendChild(make_span(id_string + "_mass_test"));
		fieldset.appendChild(document.createElement("br"));

		fieldset.appendChild(document.createTextNode("Velocity components (x, y, z) "));
		fieldset.appendChild(make_boundary_variable(id_string + "_vx", "isFinite", "time_place_context"));
		fieldset.appendChild(make_boundary_variable(id_string + "_vy", "isFinite", "time_place_context"));
		fieldset.appendChild(make_boundary_variable(id_string + "_vz", "isFinite", "time_place_context"));
		fieldset.appendChild(make_span(id_string + "_vx_test"));
		fieldset.appendChild(make_span(id_string + "_vy_test"));
		fieldset.appendChild(make_span(id_string + "_vz_test"));
		fieldset.appendChild(document.createElement("br"));

		fieldset.appendChild(document.createTextNode("Thermal pressure "));
		fieldset.appendChild(make_boundary_variable(id_string + "_pressure", "gt_zero", "time_place_context"));
		fieldset.appendChild(make_span(id_string + "_pressure_test"));
		fieldset.appendChild(document.createElement("br"));

		fieldset.appendChild(document.createTextNode("Magnetic field components (x, y, z) "));
		fieldset.appendChild(make_boundary_variable(id_string + "_Bx", "isFinite", "time_place_context"));
		fieldset.appendChild(make_boundary_variable(id_string + "_By", "isFinite", "time_place_context"));
		fieldset.appendChild(make_boundary_variable(id_string + "_Bz", "isFinite", "time_place_context"));
		fieldset.appendChild(make_span(id_string + "_Bx_test"));
		fieldset.appendChild(make_span(id_string + "_By_test"));
		fieldset.appendChild(make_span(id_string + "_Bz_test"));
		fieldset.appendChild(document.createElement("br"));
	}

	return fieldset;
}


//! callbacks to initial condition buttons
init_box_adder.addEventListener("click", function() {
	init_boxes = init_boxes + 1;
	form.appendChild(make_boundary("box", "init_box_", init_boxes.toString()));
});

init_box_remover.addEventListener("click", function() {
	var item = document.getElementById("init_box_" + init_boxes.toString());
	if (item) {
		item.parentNode.removeChild(item);
		init_boxes = init_boxes - 1;
	}
});


init_sphere_adder.addEventListener("click", function() {
	init_spheres = init_spheres + 1;
	form.appendChild(make_boundary("sphere", "init_sphere_", init_spheres.toString()));
});

init_sphere_remover.addEventListener("click", function() {
	var item = document.getElementById("init_sphere_" + init_spheres.toString());
	if (item) {
		item.parentNode.removeChild(item);
		init_spheres = init_spheres - 1;
	}
});



//! callbacks to value boundary buttons
value_box_adder.addEventListener("click", function() {
	value_boxes = value_boxes + 1;
	form.appendChild(make_boundary("box", "value_box_", value_boxes.toString()));
});

value_box_remover.addEventListener("click", function() {
	var item = document.getElementById("value_box_" + value_boxes.toString());
	if (item) {
		item.parentNode.removeChild(item);
		value_boxes = value_boxes - 1;
	}
});


value_sphere_adder.addEventListener("click", function() {
	value_spheres = value_spheres + 1;
	form.appendChild(make_boundary("sphere", "value_sphere_", value_spheres.toString()));
});

value_sphere_remover.addEventListener("click", function() {
	var item = document.getElementById("value_sphere_" + value_spheres.toString());
	if (item) {
		item.parentNode.removeChild(item);
		value_spheres = value_spheres - 1;
	}
});



//! callbacks to copy boundary buttons
copy_box_adder.addEventListener("click", function() {
	copy_boxes = copy_boxes + 1;
	form.appendChild(make_boundary("box", "copy_box_", copy_boxes.toString()));
});

copy_box_remover.addEventListener("click", function() {
	var item = document.getElementById("copy_box_" + copy_boxes.toString());
	if (item) {
		item.parentNode.removeChild(item);
		copy_boxes = copy_boxes - 1;
	}
});


copy_sphere_adder.addEventListener("click", function() {
	copy_spheres = copy_spheres + 1;
	form.appendChild(make_boundary("sphere", "copy_sphere_", copy_spheres.toString()));
});

copy_sphere_remover.addEventListener("click", function() {
	var item = document.getElementById("copy_sphere_" + copy_spheres.toString());
	if (item) {
		item.parentNode.removeChild(item);
		copy_spheres = copy_spheres - 1;
	}
});



//! sets innerHTML of item with id config_text to current configuration
config_text_updater.addEventListener("click", function() {
	var new_html
		= "<br>solver-mhd = "
		+ document.getElementById("solver_mhd").value
		+ "<br>time-start = "
		+ document.getElementById("time_start").value
		+ "<br>time-length = "
		+ document.getElementById("time_length").value
		+ "<br>save-mhd-n = "
		+ document.getElementById("save_mhd_n").value
		+ "<br>resistivity = "
		+ document.getElementById("resistivity").value
		+ "<br>remove-div-B-n = "
		+ document.getElementById("remove_div_b_n").value
		+ "<br>adiabatic-index = "
		+ document.getElementById("adiabatic_index").value
		+ "<br>vacuum-permeability = "
		+ document.getElementById("vacuum_permeability").value
		+ "<br>proton-mass = "
		+ document.getElementById("proton_mass").value
		+ "<br>time-step-factor = "
		+ document.getElementById("time_step_factor").value
		+ "<br>output-directory = "
		+ document.getElementById("output_directory").value
		+ "<br>load-balancer = RCB<br>"
		+ "[grid]<br>"
		+ "periodic = {"
		+ document.getElementById("periodic_x").value + ", "
		+ document.getElementById("periodic_y").value + ", "
		+ document.getElementById("periodic_z").value + "}<br>"
		+ "nr-cells = {"
		+ document.getElementById("cells_x").value + ", "
		+ document.getElementById("cells_y").value + ", "
		+ document.getElementById("cells_z").value + "}<br>"
		+ "volume = {"
		+ document.getElementById("volume_x").value + ", "
		+ document.getElementById("volume_y").value + ", "
		+ document.getElementById("volume_z").value + "}<br>"
		+ "start = {"
		+ document.getElementById("start_x").value + ", "
		+ document.getElementById("start_y").value + ", "
		+ document.getElementById("start_z").value + "}<br>"
		+ "[initial]"
		+ "<br>default.number-density = "
		+ document.getElementById("init_default_mass").value
		+ "<br>default.velocity = {"
		+ document.getElementById("init_default_vx").value + ", "
		+ document.getElementById("init_default_vy").value + ", "
		+ document.getElementById("init_default_vz").value + "}<br>"
		+ "default.pressure = "
		+ document.getElementById("init_default_pressure").value
		+ "<br>default.magnetic-field = {"
		+ document.getElementById("init_default_Bx").value + ", "
		+ document.getElementById("init_default_By").value + ", "
		+ document.getElementById("init_default_Bz").value + "}<br>";

	if (init_boxes > 0) {
		new_html += "nr-boxes = " + init_boxes.toString() + "<br>";
		for (i = 1; i <= init_boxes; i++) {
			var i_str = i.toString();
			var prefix = "box" + i_str + ".";
			new_html
				+= prefix + "start = {"
				+ document.getElementById("init_box_" + i_str + "_startx").value + ", "
				+ document.getElementById("init_box_" + i_str + "_starty").value + ", "
				+ document.getElementById("init_box_" + i_str + "_startz").value + "}<br>"
				+ prefix + "end = {"
				+ document.getElementById("init_box_" + i_str + "_endx").value + ", "
				+ document.getElementById("init_box_" + i_str + "_endy").value + ", "
				+ document.getElementById("init_box_" + i_str + "_endz").value + "}<br>"
				+ prefix + "number-density = "
				+ document.getElementById("init_box_" + i_str + "_mass").value + "<br>"
				+ prefix + "velocity = {"
				+ document.getElementById("init_box_" + i_str + "_vx").value + ", "
				+ document.getElementById("init_box_" + i_str + "_vy").value + ", "
				+ document.getElementById("init_box_" + i_str + "_vz").value + "}<br>"
				+ prefix + "pressure = "
				+ document.getElementById("init_box_" + i_str + "_pressure").value + "<br>"
				+ prefix + "magnetic-field = {"
				+ document.getElementById("init_box_" + i_str + "_Bx").value + ", "
				+ document.getElementById("init_box_" + i_str + "_By").value + ", "
				+ document.getElementById("init_box_" + i_str + "_Bz").value + "}<br>";
		}
	}

	if (init_spheres > 0) {
		new_html += "nr-spheres = " + init_spheres.toString() + "<br>";
		for (i = 1; i <= init_spheres; i++) {
			var i_str = i.toString();
			var prefix = "sphere" + i_str + ".";
			new_html
				+= prefix + "center = {"
				+ document.getElementById("init_sphere_" + i_str + "_centerx").value + ", "
				+ document.getElementById("init_sphere_" + i_str + "_centery").value + ", "
				+ document.getElementById("init_sphere_" + i_str + "_centerz").value + "}<br>"
				+ prefix + "radius = "
				+ document.getElementById("init_sphere_" + i_str + "_radius").value + "<br>"
				+ prefix + "number-density = "
				+ document.getElementById("init_sphere_" + i_str + "_mass").value + "<br>"
				+ prefix + "velocity = {"
				+ document.getElementById("init_sphere_" + i_str + "_vx").value + ", "
				+ document.getElementById("init_sphere_" + i_str + "_vy").value + ", "
				+ document.getElementById("init_sphere_" + i_str + "_vz").value + "}<br>"
				+ prefix + "pressure = "
				+ document.getElementById("init_sphere_" + i_str + "_pressure").value + "<br>"
				+ prefix + "magnetic-field = {"
				+ document.getElementById("init_sphere_" + i_str + "_Bx").value + ", "
				+ document.getElementById("init_sphere_" + i_str + "_By").value + ", "
				+ document.getElementById("init_sphere_" + i_str + "_Bz").value + "}<br>";
		}
	}

	if (value_boxes > 0 || value_spheres > 0) {
		new_html += "[value-boundaries]<br>";
	}

	if (value_boxes > 0) {
		new_html += "nr-boxes = " + value_boxes.toString() + "<br>";
		for (i = 1; i <= value_boxes; i++) {
			var i_str = i.toString();
			var prefix = "box" + i_str + ".";
			new_html
				+= prefix + "start = {"
				+ document.getElementById("value_box_" + i_str + "_startx").value + ", "
				+ document.getElementById("value_box_" + i_str + "_starty").value + ", "
				+ document.getElementById("value_box_" + i_str + "_startz").value + "}<br>"
				+ prefix + "end = {"
				+ document.getElementById("value_box_" + i_str + "_endx").value + ", "
				+ document.getElementById("value_box_" + i_str + "_endy").value + ", "
				+ document.getElementById("value_box_" + i_str + "_endz").value + "}<br>"
				+ prefix + "time = "
				+ document.getElementById("value_box_" + i_str + "_time").value + "<br>"
				+ prefix + "number-density = "
				+ document.getElementById("value_box_" + i_str + "_mass").value + "<br>"
				+ prefix + "velocity = {"
				+ document.getElementById("value_box_" + i_str + "_vx").value + ", "
				+ document.getElementById("value_box_" + i_str + "_vy").value + ", "
				+ document.getElementById("value_box_" + i_str + "_vz").value + "}<br>"
				+ prefix + "pressure = "
				+ document.getElementById("value_box_" + i_str + "_pressure").value + "<br>"
				+ prefix + "magnetic-field = {"
				+ document.getElementById("value_box_" + i_str + "_Bx").value + ", "
				+ document.getElementById("value_box_" + i_str + "_By").value + ", "
				+ document.getElementById("value_box_" + i_str + "_Bz").value + "}<br>";
		}
	}

	if (value_spheres > 0) {
		new_html += "nr-spheres = " + value_spheres.toString() + "<br>";
		for (i = 1; i <= value_spheres; i++) {
			var i_str = i.toString();
			var prefix = "sphere" + i_str + ".";
			new_html
				+= prefix + "center = {"
				+ document.getElementById("value_sphere_" + i_str + "_centerx").value + ", "
				+ document.getElementById("value_sphere_" + i_str + "_centery").value + ", "
				+ document.getElementById("value_sphere_" + i_str + "_centerz").value + "}<br>"
				+ prefix + "radius = "
				+ document.getElementById("value_sphere_" + i_str + "_radius").value + "<br>"
				+ prefix + "time = "
				+ document.getElementById("value_sphere_" + i_str + "_time").value + "<br>"
				+ prefix + "number-density = "
				+ document.getElementById("value_sphere_" + i_str + "_mass").value + "<br>"
				+ prefix + "velocity = {"
				+ document.getElementById("value_sphere_" + i_str + "_vx").value + ", "
				+ document.getElementById("value_sphere_" + i_str + "_vy").value + ", "
				+ document.getElementById("value_sphere_" + i_str + "_vz").value + "}<br>"
				+ prefix + "pressure = "
				+ document.getElementById("value_sphere_" + i_str + "_pressure").value + "<br>"
				+ prefix + "magnetic-field = {"
				+ document.getElementById("value_sphere_" + i_str + "_Bx").value + ", "
				+ document.getElementById("value_sphere_" + i_str + "_By").value + ", "
				+ document.getElementById("value_sphere_" + i_str + "_Bz").value + "}<br>";
		}
	}


	if (copy_boxes > 0 || copy_spheres > 0) {
		new_html += "[copy-boundaries]<br>";
	}

	if (copy_boxes > 0) {
		new_html += "nr-boxes = " + copy_boxes.toString() + "<br>";
		for (i = 1; i <= copy_boxes; i++) {
			var i_str = i.toString();
			var prefix = "box" + i_str + ".";
			new_html
				+= prefix + "start = {"
				+ document.getElementById("copy_box_" + i_str + "_startx").value + ", "
				+ document.getElementById("copy_box_" + i_str + "_starty").value + ", "
				+ document.getElementById("copy_box_" + i_str + "_startz").value + "}<br>"
				+ prefix + "end = {"
				+ document.getElementById("copy_box_" + i_str + "_endx").value + ", "
				+ document.getElementById("copy_box_" + i_str + "_endy").value + ", "
				+ document.getElementById("copy_box_" + i_str + "_endz").value + "}<br>";
		}
	}

	if (copy_spheres > 0) {
		new_html += "nr-spheres = " + copy_spheres.toString() + "<br>";
		for (i = 1; i <= copy_spheres; i++) {
			var i_str = i.toString();
			var prefix = "sphere" + i_str + ".";
			new_html
				+= prefix + "center = {"
				+ document.getElementById("copy_sphere_" + i_str + "_centerx").value + ", "
				+ document.getElementById("copy_sphere_" + i_str + "_centery").value + ", "
				+ document.getElementById("copy_sphere_" + i_str + "_centerz").value + "}<br>"
				+ prefix + "radius = "
				+ document.getElementById("copy_sphere_" + i_str + "_radius").value + "<br>";
		}
	}


	var config_text = document.getElementById("config_text");
	while (config_text.hasChildNodes()) {
	    config_text.removeChild(config_text.firstChild);
	}
	config_text.innerHTML = new_html;
});

function remove_boundaries() {
	while (init_boxes > 0) { init_box_remover.click(); }
	while (init_spheres > 0) { init_sphere_remover.click(); }
	while (value_boxes > 0) { value_box_remover.click(); }
	while (value_spheres > 0) { value_sphere_remover.click(); }
	while (copy_boxes > 0) { copy_box_remover.click(); }
	while (copy_spheres > 0) { copy_sphere_remover.click(); }
}

clearer.addEventListener("click", function() {
	remove_boundaries();
	document.getElementById("solver_mhd").selectedIndex = "2";
	document.getElementById("time_start").value = "";
	document.getElementById("time_length").value = "";
	document.getElementById("save_mhd_n").value = "";
	document.getElementById("resistivity").value = "";
	document.getElementById("remove_div_b_n").value = "";
	document.getElementById("adiabatic_index").value = "";
	document.getElementById("vacuum_permeability").value = "";
	document.getElementById("proton_mass").value = "";
	document.getElementById("time_step_factor").value = "";
	document.getElementById("output_directory").value = "";
	document.getElementById("periodic_x").selectedIndex = "0";
	document.getElementById("periodic_y").selectedIndex = "0";
	document.getElementById("periodic_z").selectedIndex = "0";
	document.getElementById("cells_x").value = "";
	document.getElementById("cells_y").value = "";
	document.getElementById("cells_z").value = "";
	document.getElementById("volume_x").value = "";
	document.getElementById("volume_y").value = "";
	document.getElementById("volume_z").value = "";
	document.getElementById("start_x").value = "";
	document.getElementById("start_y").value = "";
	document.getElementById("start_z").value = "";
	document.getElementById("init_default_mass").value = "";
	document.getElementById("init_default_pressure").value = "";
	document.getElementById("init_default_vx").value = "";
	document.getElementById("init_default_vy").value = "";
	document.getElementById("init_default_vz").value = "";
	document.getElementById("init_default_Bx").value = "";
	document.getElementById("init_default_By").value = "";
	document.getElementById("init_default_Bz").value = "";
	var config_text = document.getElementById("config_text");
	while (config_text.hasChildNodes()) {
	    config_text.removeChild(config_text.firstChild);
	}
	config_text.innerHTML
		= "<br>Push the button above to see contents of current configuration file";
});

//! buttons for example simulations
shock_tube_maker.addEventListener("click", function() {
	remove_boundaries();
	document.getElementById("solver_mhd").selectedIndex = "2";
	document.getElementById("time_start").value = "0";
	document.getElementById("time_length").value = "1";
	document.getElementById("save_mhd_n").value = "0.1";
	document.getElementById("resistivity").value = "0";
	document.getElementById("remove_div_b_n").value = "-1";
	document.getElementById("adiabatic_index").value = "1.6666667";
	document.getElementById("vacuum_permeability").value = "1";
	document.getElementById("proton_mass").value = "1";
	document.getElementById("time_step_factor").value = "0.5";
	document.getElementById("output_directory").value = "shock_tube/";
	document.getElementById("periodic_x").selectedIndex = "0";
	document.getElementById("periodic_y").selectedIndex = "0";
	document.getElementById("periodic_z").selectedIndex = "0";
	document.getElementById("cells_x").value = "100 + 2";
	document.getElementById("cells_y").value = "1";
	document.getElementById("cells_z").value = "1";
	document.getElementById("volume_x").value = "1 + 2.0/100";
	document.getElementById("volume_y").value = "1";
	document.getElementById("volume_z").value = "1";
	document.getElementById("start_x").value = "-0.5 - 1.0/100";
	document.getElementById("start_y").value = "-0.5";
	document.getElementById("start_z").value = "-0.5";
	document.getElementById("init_default_mass").value = "(r[0] < 0) ? 1 : 0.125";
	document.getElementById("init_default_pressure").value = "(r[0] < 0) ? 1 : 0.1";
	document.getElementById("init_default_vx").value = "0";
	document.getElementById("init_default_vy").value = "0";
	document.getElementById("init_default_vz").value = "0";
	document.getElementById("init_default_Bx").value = "0.75";
	document.getElementById("init_default_By").value = "(r[0] < 0) ? 1 : -1";
	document.getElementById("init_default_Bz").value = "0";
	value_box_adder.click();
	document.getElementById("value_box_1_startx").value = "-99";
	document.getElementById("value_box_1_starty").value = "-99";
	document.getElementById("value_box_1_startz").value = "-99";
	document.getElementById("value_box_1_endx").value = "-0.5";
	document.getElementById("value_box_1_endy").value = "99";
	document.getElementById("value_box_1_endz").value = "99";
	document.getElementById("value_box_1_time").value = "0";
	document.getElementById("value_box_1_mass").value = "1";
	document.getElementById("value_box_1_pressure").value = "1";
	document.getElementById("value_box_1_vx").value = "0";
	document.getElementById("value_box_1_vy").value = "0";
	document.getElementById("value_box_1_vz").value = "0";
	document.getElementById("value_box_1_Bx").value = "0.75";
	document.getElementById("value_box_1_By").value = "1";
	document.getElementById("value_box_1_Bz").value = "0";
	value_box_adder.click();
	document.getElementById("value_box_2_startx").value = "0.5";
	document.getElementById("value_box_2_starty").value = "-99";
	document.getElementById("value_box_2_startz").value = "-99";
	document.getElementById("value_box_2_endx").value = "99";
	document.getElementById("value_box_2_endy").value = "99";
	document.getElementById("value_box_2_endz").value = "99";
	document.getElementById("value_box_2_time").value = "0";
	document.getElementById("value_box_2_mass").value = "0.125";
	document.getElementById("value_box_2_pressure").value = "0.1";
	document.getElementById("value_box_2_vx").value = "0";
	document.getElementById("value_box_2_vy").value = "0";
	document.getElementById("value_box_2_vz").value = "0";
	document.getElementById("value_box_2_Bx").value = "0.75";
	document.getElementById("value_box_2_By").value = "-1";
	document.getElementById("value_box_2_Bz").value = "0";
	config_text_updater.click();
});

kelvin_helmholtz_maker.addEventListener("click", function() {
	remove_boundaries();
	document.getElementById("solver_mhd").selectedIndex = "2";
	document.getElementById("time_start").value = "0";
	document.getElementById("time_length").value = "12";
	document.getElementById("save_mhd_n").value = "1";
	document.getElementById("resistivity").value = "0";
	document.getElementById("remove_div_b_n").value = "0.05";
	document.getElementById("adiabatic_index").value = "1.4";
	document.getElementById("vacuum_permeability").value = "1";
	document.getElementById("proton_mass").value = "1";
	document.getElementById("time_step_factor").value = "0.5";
	document.getElementById("output_directory").value = "kelvin-helmholtz/";
	document.getElementById("periodic_x").selectedIndex = "1";
	document.getElementById("periodic_y").selectedIndex = "1";
	document.getElementById("periodic_z").selectedIndex = "0";
	document.getElementById("cells_x").value = "50";
	document.getElementById("cells_y").value = "50";
	document.getElementById("cells_z").value = "1";
	document.getElementById("volume_x").value = "1";
	document.getElementById("volume_y").value = "1";
	document.getElementById("volume_z").value = "1";
	document.getElementById("start_x").value = "-0.5";
	document.getElementById("start_y").value = "-0.5";
	document.getElementById("start_z").value = "-0.5";
	document.getElementById("init_default_mass").value = "abs(r[1]) < 0.25 ? 2 : 1";
	document.getElementById("init_default_pressure").value = "3";
	document.getElementById("init_default_vx").value
		= "0.1 * sin(2*pi*r[0]) + (abs(r[1]) < 0.25 ? -0.5 : 0.5)";
	document.getElementById("init_default_vy").value = "0.1 * cos(2*pi*r[0])";
	document.getElementById("init_default_vz").value = "0";
	document.getElementById("init_default_Bx").value = "0.25";
	document.getElementById("init_default_By").value = "0";
	document.getElementById("init_default_Bz").value = "0";
	config_text_updater.click();
});

reconnection_maker.addEventListener("click", function() {
	remove_boundaries();
	document.getElementById("solver_mhd").selectedIndex = "2";
	document.getElementById("time_start").value = "0";
	document.getElementById("time_length").value = "20";
	document.getElementById("save_mhd_n").value = "1";
	document.getElementById("resistivity").value = "0";
	document.getElementById("remove_div_b_n").value = "0.2";
	document.getElementById("adiabatic_index").value = "1.666667";
	document.getElementById("vacuum_permeability").value = "1";
	document.getElementById("proton_mass").value = "1";
	document.getElementById("time_step_factor").value = "0.5";
	document.getElementById("output_directory").value = "reconnection/";
	document.getElementById("periodic_x").selectedIndex = "1";
	document.getElementById("periodic_y").selectedIndex = "0";
	document.getElementById("periodic_z").selectedIndex = "0";
	document.getElementById("cells_x").value = "2*51";
	document.getElementById("cells_y").value = "1";
	document.getElementById("cells_z").value = "51 + 2";
	document.getElementById("volume_x").value = "25.6";
	document.getElementById("volume_y").value = "12.8";
	document.getElementById("volume_z").value = "12.8 * (1 + 2.0/51)";
	document.getElementById("start_x").value = "-12.8";
	document.getElementById("start_y").value = "-6.4";
	document.getElementById("start_z").value = "-6.4 * (1 + 2.0/51)";
	document.getElementById("init_default_mass").value
		= "1/cosh(r[2] / 0.5)^2 + 0.2";
	document.getElementById("init_default_pressure").value = "1";
	document.getElementById("init_default_vx").value = "0";
	document.getElementById("init_default_vy").value = "0";
	document.getElementById("init_default_vz").value = "0";
	document.getElementById("init_default_Bx").value
		= "tanh(r[2] / 0.5) - 0.1 * pi/12.8 * cos(2*pi*r[0]/25.6) * sin(pi*r[2]/12.8)";
	document.getElementById("init_default_By").value = "0";
	document.getElementById("init_default_Bz").value
		= "0.1 * 2*pi/25.6 * sin(2*pi*r[0]/25.6) * cos(pi*r[2]/12.8)";
	copy_box_adder.click();
	document.getElementById("copy_box_1_startx").value = "-999";
	document.getElementById("copy_box_1_starty").value = "-999";
	document.getElementById("copy_box_1_startz").value = "6.4";
	document.getElementById("copy_box_1_endx").value = "999";
	document.getElementById("copy_box_1_endy").value = "999";
	document.getElementById("copy_box_1_endz").value = "999";
	copy_box_adder.click();
	document.getElementById("copy_box_2_startx").value = "-999";
	document.getElementById("copy_box_2_starty").value = "-999";
	document.getElementById("copy_box_2_startz").value = "-999";
	document.getElementById("copy_box_2_endx").value = "999";
	document.getElementById("copy_box_2_endy").value = "999";
	document.getElementById("copy_box_2_endz").value = "-6.4";
	config_text_updater.click();
});

orszag_tang_maker.addEventListener("click", function() {
	remove_boundaries();
	document.getElementById("solver_mhd").selectedIndex = "2";
	document.getElementById("time_start").value = "0";
	document.getElementById("time_length").value = "5";
	document.getElementById("save_mhd_n").value = "0.5";
	document.getElementById("resistivity").value = "0";
	document.getElementById("remove_div_b_n").value = "0.1";
	document.getElementById("adiabatic_index").value = "1.666667";
	document.getElementById("vacuum_permeability").value = "1";
	document.getElementById("proton_mass").value = "1";
	document.getElementById("time_step_factor").value = "0.5";
	document.getElementById("output_directory").value = "orszag-tang/";
	document.getElementById("periodic_x").selectedIndex = "1";
	document.getElementById("periodic_y").selectedIndex = "1";
	document.getElementById("periodic_z").selectedIndex = "0";
	document.getElementById("cells_x").value = "40";
	document.getElementById("cells_y").value = "40";
	document.getElementById("cells_z").value = "1";
	document.getElementById("volume_x").value = "2*pi";
	document.getElementById("volume_y").value = "2*pi";
	document.getElementById("volume_z").value = "1";
	document.getElementById("start_x").value = "0";
	document.getElementById("start_y").value = "0";
	document.getElementById("start_z").value = "0";
	document.getElementById("init_default_mass").value = "1";
	document.getElementById("init_default_pressure").value = "1";
	document.getElementById("init_default_vx").value = "-sin(r[1])";
	document.getElementById("init_default_vy").value = "sin(r[0])";
	document.getElementById("init_default_vz").value = "0";
	document.getElementById("init_default_Bx").value = "-sin(r[1])";
	document.getElementById("init_default_By").value = "sin(2 * r[0])";
	document.getElementById("init_default_Bz").value = "0";
	config_text_updater.click();
});

bow_shock_maker.addEventListener("click", function() {
	remove_boundaries();
	document.getElementById("solver_mhd").selectedIndex = "1";
	document.getElementById("time_start").value = "0";
	document.getElementById("time_length").value = "10";
	document.getElementById("save_mhd_n").value = "1";
	document.getElementById("resistivity").value = "0";
	document.getElementById("remove_div_b_n").value = "-1";
	document.getElementById("adiabatic_index").value = "1.666667";
	document.getElementById("vacuum_permeability").value = "1";
	document.getElementById("proton_mass").value = "1";
	document.getElementById("time_step_factor").value = "0.5";
	document.getElementById("output_directory").value = "bow_shock/";
	document.getElementById("periodic_x").selectedIndex = "0";
	document.getElementById("periodic_y").selectedIndex = "0";
	document.getElementById("periodic_z").selectedIndex = "0";
	document.getElementById("cells_x").value = "2*30 + 2";
	document.getElementById("cells_y").value = "3*30 + 2";
	document.getElementById("cells_z").value = "1";
	document.getElementById("volume_x").value = "2 + 2/30";
	document.getElementById("volume_y").value = "3 + 2/30";
	document.getElementById("volume_z").value = "2";
	document.getElementById("start_x").value = "-1 - 1/30";
	document.getElementById("start_y").value = "-1.5 - 1/30";
	document.getElementById("start_z").value = "-1";
	document.getElementById("init_default_mass").value = "0.01";
	document.getElementById("init_default_pressure").value = "0.0015";
	document.getElementById("init_default_vx").value = "r[0] > 0 and r[1] < 0.0625 and r[1] > -0.0625 ? 0 : 1";
	document.getElementById("init_default_vy").value = "0";
	document.getElementById("init_default_vz").value = "0";
	document.getElementById("init_default_Bx").value = "0";
	document.getElementById("init_default_By").value = "0";
	document.getElementById("init_default_Bz").value = "0";
	init_sphere_adder.click();
	document.getElementById("init_sphere_1_centerx").value = "0";
	document.getElementById("init_sphere_1_centery").value = "0";
	document.getElementById("init_sphere_1_centerz").value = "0";
	document.getElementById("init_sphere_1_radius").value = "0.0625";
	document.getElementById("init_sphere_1_mass").value = "100";
	document.getElementById("init_sphere_1_pressure").value = "0.0015";
	document.getElementById("init_sphere_1_vx").value = "0";
	document.getElementById("init_sphere_1_vy").value = "0";
	document.getElementById("init_sphere_1_vz").value = "0";
	document.getElementById("init_sphere_1_Bx").value = "0";
	document.getElementById("init_sphere_1_By").value = "0";
	document.getElementById("init_sphere_1_Bz").value = "0";
	value_box_adder.click();
	document.getElementById("value_box_1_startx").value = "-99";
	document.getElementById("value_box_1_starty").value = "-99";
	document.getElementById("value_box_1_startz").value = "-99";
	document.getElementById("value_box_1_endx").value = "-1";
	document.getElementById("value_box_1_endy").value = "99";
	document.getElementById("value_box_1_endz").value = "99";
	document.getElementById("value_box_1_time").value = "0";
	document.getElementById("value_box_1_mass").value = "0.01";
	document.getElementById("value_box_1_pressure").value = "0.0015";
	document.getElementById("value_box_1_vx").value = "1";
	document.getElementById("value_box_1_vy").value = "0";
	document.getElementById("value_box_1_vz").value = "0";
	document.getElementById("value_box_1_Bx").value = "0";
	document.getElementById("value_box_1_By").value = "0";
	document.getElementById("value_box_1_Bz").value = "0";
	copy_box_adder.click();
	document.getElementById("copy_box_1_startx").value = "1";
	document.getElementById("copy_box_1_starty").value = "-99";
	document.getElementById("copy_box_1_startz").value = "-99";
	document.getElementById("copy_box_1_endx").value = "99";
	document.getElementById("copy_box_1_endy").value = "99";
	document.getElementById("copy_box_1_endz").value = "99";
	copy_box_adder.click();
	document.getElementById("copy_box_2_startx").value = "-99";
	document.getElementById("copy_box_2_starty").value = "1.5";
	document.getElementById("copy_box_2_startz").value = "-99";
	document.getElementById("copy_box_2_endx").value = "99";
	document.getElementById("copy_box_2_endy").value = "99";
	document.getElementById("copy_box_2_endz").value = "99";
	copy_box_adder.click()
	document.getElementById("copy_box_3_startx").value = "-99";
	document.getElementById("copy_box_3_starty").value = "-99";
	document.getElementById("copy_box_3_startz").value = "-99";
	document.getElementById("copy_box_3_endx").value = "99";
	document.getElementById("copy_box_3_endy").value = "-1.5";
	document.getElementById("copy_box_3_endz").value = "99";
	config_text_updater.click();
});

blast_wave_maker.addEventListener("click", function() {
	remove_boundaries();
	document.getElementById("solver_mhd").selectedIndex = "2";
	document.getElementById("time_start").value = "0";
	document.getElementById("time_length").value = "0.5";
	document.getElementById("save_mhd_n").value = "0.05";
	document.getElementById("resistivity").value = "0";
	document.getElementById("remove_div_b_n").value = "0.05";
	document.getElementById("adiabatic_index").value = "1.666667";
	document.getElementById("vacuum_permeability").value = "1";
	document.getElementById("proton_mass").value = "1";
	document.getElementById("time_step_factor").value = "0.5";
	document.getElementById("output_directory").value = "blast_wave/";
	document.getElementById("periodic_x").selectedIndex = "1";
	document.getElementById("periodic_y").selectedIndex = "1";
	document.getElementById("periodic_z").selectedIndex = "0";
	document.getElementById("cells_x").value = "100";
	document.getElementById("cells_y").value = "100";
	document.getElementById("cells_z").value = "1";
	document.getElementById("volume_x").value = "1";
	document.getElementById("volume_y").value = "1";
	document.getElementById("volume_z").value = "1";
	document.getElementById("start_x").value = "-0.5";
	document.getElementById("start_y").value = "-0.5";
	document.getElementById("start_z").value = "-0.5";
	document.getElementById("init_default_mass").value = "1";
	document.getElementById("init_default_pressure").value = "0.1";
	document.getElementById("init_default_vx").value = "0";
	document.getElementById("init_default_vy").value = "0";
	document.getElementById("init_default_vz").value = "0";
	document.getElementById("init_default_Bx").value = "1/sqrt(2)";
	document.getElementById("init_default_By").value = "1/sqrt(2)";
	document.getElementById("init_default_Bz").value = "0";
	init_sphere_adder.click();
	document.getElementById("init_sphere_1_centerx").value = "0";
	document.getElementById("init_sphere_1_centery").value = "0";
	document.getElementById("init_sphere_1_centerz").value = "0";
	document.getElementById("init_sphere_1_radius").value = "0.125";
	document.getElementById("init_sphere_1_mass").value = "1";
	document.getElementById("init_sphere_1_pressure").value = "10";
	document.getElementById("init_sphere_1_vx").value = "0";
	document.getElementById("init_sphere_1_vy").value = "0";
	document.getElementById("init_sphere_1_vz").value = "0";
	document.getElementById("init_sphere_1_Bx").value = "1/sqrt(2)";
	document.getElementById("init_sphere_1_By").value = "1/sqrt(2)";
	document.getElementById("init_sphere_1_Bz").value = "0";
	config_text_updater.click();
});

}

//! converts parentheses in submitted form to brackets
function convert_parentheses() {
	for (i in form.elements) {
		element = form.elements[i];
		if (typeof element.value == "string") {
			element.value = element.value.split("(").join("[").split(")").join("]");
		}
	}
	return true;
}

<!-- javascript functions end -->

</script>

<!-- javascript block end -->

</head>

<body>

<!-- configuration creator start -->

<h1>Configuration file creator for MHD test program of PAMHD</h1>

<h2>Presets</h2>
<p>
Use these buttons to automatically fill the forms below to create configuration files for some example simulations.
The corresponding configuration file will appear at the bottom of the page which you can copy &amp; paste into a local file and give to pamhd/tests/mhd/test.exe via its command line argument --config-file.<br>
<button id="make_shock_tube" type="button">Shock tube</button>
<button id="make_kelvin_helmholtz" type="button">Kelvin-Helmholtz</button>
<button id="make_reconnection" type="button">Reconnection</button>
<button id="make_orszag_tang" type="button">Orszag-Tang</button>
<button id="make_bow_shock" type="button">Bow shock</button>
<button id="make_blast_wave" type="button">Blast wave</button>
</p>

<h2>Configuration interface</h2>
<p>
Fill out the below forms with simulation parameters and hit the update button to see how the corresponding configuration file looks like.
Use the add and remove buttons to modify the number of additional regions of different types of boundaries:
<ul>
<li>initial state: before simulation is started these regions are filled with given data</li>
<li>value boundary: when simulation is running these regions are filled with given data after every solution</li>
<li>copy boundary: when simulation is running these regions set their value based on data in nearest non-boundary cells after every solution</li>
</ul>
Expressions for values of MHD variables can refer to the x, y and z coordinates of cells' center with r[0], r[1] and r[2] respectively and current simulation time with t.
</p>

<p>
<button id="add_init_box" type="button">
	Add a new box region for setting initial simulation state
</button>
<button id="remove_init_box" type="button">
	Remove last box region of initial simulation state
</button><br>
<button id="add_init_sphere" type="button">
	Add a new spherical region for setting initial simulation state
</button>
<button id="remove_init_sphere" type="button">
	Remove last spherical region of initial simulation state
</button><br>
</p>

<p>
<button id="add_value_box" type="button">
	Add a new box region for value boundary
</button>
<button id="remove_value_box" type="button">
	Remove last box region of value boundary
</button><br>
<button id="add_value_sphere" type="button">
	Add a new spherical region for value boundary
</button>
<button id="remove_value_sphere" type="button">
	Remove last spherical region of value boundary
</button><br>
</p>

<p>
<button id="add_copy_box" type="button">
	Add a new box region for copy boundary
</button>
<button id="remove_copy_box" type="button">
	Remove last box region of copy boundary
</button><br>
<button id="add_copy_sphere" type="button">
	Add a new spherical region for copy boundary
</button>
<button id="remove_copy_sphere" type="button">
	Remove last spherical region of copy boundary
</button><br>
</p>

<button id="clear" type="button">Clear</button>

<!-- form start -->

<form method="get" id="form" onsubmit="convert_parentheses()">
	<input type="submit" value="Submit run"><br>
	<fieldset id="simulation">
		<legend>General simulation parameteres</legend>

		Solver to use
		<select id="solver_mhd" name="solver_mhd" required>
			<option value="hll_athena">hll_athena</option>
			<option value="hlld_athena">hlld_athena</option>
			<option value="roe_athena" selected>roe_athena</option>
		</select><br>

		Start time of simulation
		<input
			type="text"
			id="time_start"
			name="time_start"
			onKeyUp="validate_expression(this.id, isFinite, empty_context)"
		>
			<span id="time_start_test"></span>
		<br>

		Duration of simulation (> 0)
		<input
			type="text"
			id="time_length"
			name="time_length"
			onKeyUp="validate_expression(this.id, gt_zero, empty_context)"
		>
			<span id="time_length_test"></span>
		<br>

		Time interval for saving simulation results (< 0 skips saving)
		<input
			type="text"
			id="save_mhd_n"
			name="save_mhd_n"
			onKeyUp="validate_expression(this.id, isFinite, empty_context)"
		>
			<span id="save_mhd_n_test"></span>
		<br>

		Expression for electric resistivity (can also refer to magnitude of electric current density as J)
		<input
			type="text"
			id="resistivity"
			name="resistivity"
			onKeyUp="validate_expression(this.id, isFinite, time_place_current_context)"><span id="resistivity_test"></span>
		<br>

		Time interval for removing divergence of magnetic field (< 0 skips removal)
		<input
			type="text"
			id="remove_div_b_n"
			name="remove_div_b_n"
			onKeyUp="validate_expression(this.id, isFinite, empty_context)"><span id="remove_div_b_n_test"></span>
		<br>

		Value of adiabatic index (> 1)
		<input
			type="text"
			id="adiabatic_index"
			name="adiabatic_index"
			onKeyUp="validate_expression(this.id, gt_zero, empty_context)"><span id="adiabatic_index_test"></span>
		<br>

		Value of vacuum permeability (> 0)
		<input
			type="text"
			id="vacuum_permeability"
			name="vacuum_permeability"
			onKeyUp="validate_expression(this.id, gt_zero, empty_context)"><span id="vacuum_permeability_test"></span>
		<br>

		Value of proton mass (> 0)
		<input
			type="text"
			id="proton_mass"
			name="proton_mass"
			onKeyUp="validate_expression(this.id, gt_zero, empty_context)"><span id="proton_mass_test"></span>
		<br>

		Fraction of maximum allowed time step to use (> 0, < 1)
		<input
			type="text"
			id="time_step_factor"
			name="time_step_factor"
			onKeyUp="validate_expression(this.id, gt_zero, empty_context)"><span id="time_step_factor_test"></span>
		<br>

		Output directory for results relative to current directory
		<input
			type="text"
			id="output_directory"
			name="output_directory">
		<br>
	</fieldset>

	<fieldset id="grid">
		<legend>Parameters of simulation grid</legend>
		Periodicity in x, y and z dimensions

		<select id="periodic_x" name="periodic_x" required>
			<option value="false">false</option>
			<option value="true">true</option>
		</select>
		<select id="periodic_y" name="periodic_y" required>
			<option value="false">false</option>
			<option value="true">true</option>
		</select>
		<select id="periodic_z" name="periodic_z" required>
			<option value="false">false</option>
			<option value="true">true</option>
		</select>
		<br>

		Number of cells in x, y and z dimensions (> 0)
		<input
			type="text"
			id="cells_x"
			name="cells_x"
			onKeyUp="validate_expression(this.id, gt_zero, empty_context)"
		>
			<span id="cells_x_test"></span>
		<input
			type="text"
			id="cells_y"
			name="cells_y"
			onKeyUp="validate_expression(this.id, gt_zero, empty_context)"
		>
			<span id="cells_y_test"></span>
		<input
			type="text"
			id="cells_z"
			name="cells_z"
			onKeyUp="validate_expression(this.id, gt_zero, empty_context)"
		>
			<span id="cells_z_test"></span>
		<br>

		Volume in x, y and z dimensions (> 0)
		<input
			type="text"
			id="volume_x"
			name="volume_x"
			onKeyUp="validate_expression(this.id, gt_zero, empty_context)"
		>
			<span id="volume_x_test"></span>
		<input
			type="text"
			id="volume_y"
			name="volume_y"
			onKeyUp="validate_expression(this.id, gt_zero, empty_context)"
		>
			<span id="volume_y_test"></span>
		<input
			type="text"
			id="volume_z"
			name="volume_z"
			onKeyUp="validate_expression(this.id, gt_zero, empty_context)"
		>
			<span id="volume_z_test"></span>
		<br>

		Starting coordinate in x, y and z dimensions
		<input
			type="text"
			id="start_x"
			name="start_x"
			onKeyUp="validate_expression(this.id, isFinite, empty_context)"
		>
			<span id="start_x_test"></span>
		<input
			type="text"
			id="start_y"
			name="start_y"
			onKeyUp="validate_expression(this.id, isFinite, empty_context)"
		>
			<span id="start_y_test"></span>
		<input
			type="text"
			id="start_z"
			name="start_z"
			onKeyUp="validate_expression(this.id, isFinite, empty_context)"
		>
			<span id="start_z_test"></span>
		<br>
	</fieldset>

	<fieldset id="default_initial_condition">
		<legend>Default initial condition of the simulation</legend>

		Number density (> 0)
		<input
			type="text"
			id="init_default_mass"
			name="init_default_mass"
			onKeyUp="validate_expression(this.id, gt_zero, time_place_context)"
		>
			<span id="init_default_mass_test"></span>
		<br>

		Thermal pressure (> 0)
		<input
			type="text"
			id="init_default_pressure"
			name="init_default_pressure"
			onKeyUp="validate_expression(this.id, gt_zero, time_place_context)"
		>
			<span id="init_default_pressure_test"></span>
		<br>

		Velocity components (x, y, z)
		<input
			type="text"
			id="init_default_vx"
			name="init_default_vx"
			onKeyUp="validate_expression(this.id, isFinite, time_place_context)"
		>
			<span id="init_default_vx_test"></span>
		<input
			type="text"
			id="init_default_vy"
			name="init_default_vy"
			onKeyUp="validate_expression(this.id, isFinite, time_place_context)"
		>
			<span id="init_default_vy_test"></span>
		<input
			type="text"
			id="init_default_vz"
			name="init_default_vz"
			onKeyUp="validate_expression(this.id, isFinite, time_place_context)"
		>
			<span id="init_default_vz_test"></span>
		<br>

		Magnetic field components (x, y, z)
		<input
			type="text"
			id="init_default_Bx"
			name="init_default_Bx"
			onKeyUp="validate_expression(this.id, isFinite, time_place_context)"
		>
			<span id="init_default_Bx_test"></span>
		<input
			type="text"
			id="init_default_By"
			name="init_default_By"
			onKeyUp="validate_expression(this.id, isFinite, time_place_context)"
		>
			<span id="init_default_By_test"></span>
		<input
			type="text"
			id="init_default_Bz"
			name="init_default_Bz"
			onKeyUp="validate_expression(this.id, isFinite, time_place_context)"
		>
			<span id="init_default_Bz_test"></span>
		<br>
	</fieldset>
</form>
<button id="update_config_text" type="button">Update config file contents</button> 
<samp id="config_text"><br>Push the button above to see contents of current configuration file</samp>

<!-- form end -->

</body>
</html>
